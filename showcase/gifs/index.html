<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GIF 만들기 | WGPU 학습하기</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/learn-wgpu-ko/assets/css/0.styles.146801cf.css" as="style"><link rel="preload" href="/learn-wgpu-ko/assets/js/app.ed4e872b.js" as="script"><link rel="preload" href="/learn-wgpu-ko/assets/js/3.d666109b.js" as="script"><link rel="preload" href="/learn-wgpu-ko/assets/js/2.3bb15672.js" as="script"><link rel="preload" href="/learn-wgpu-ko/assets/js/49.a2e992fc.js" as="script"><link rel="preload" href="/learn-wgpu-ko/assets/js/37.a2b9f953.js" as="script"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/1.187b396e.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/10.1c2d648c.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/11.3ec612b9.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/12.e324cc11.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/13.84916e1a.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/14.109a5894.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/15.887bfa51.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/16.4611bcb5.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/17.27051486.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/18.f6ad2768.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/19.40ff5aaa.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/20.178554f0.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/21.9e299fcc.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/22.c7ead717.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/23.ab028ab4.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/24.fc889c2f.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/25.941e3dd6.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/26.f270b4cd.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/27.858fd637.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/28.0f431dfe.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/29.098da917.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/30.379eac67.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/31.3b679374.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/32.f42ff376.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/33.ac5b507a.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/34.50a4fad6.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/35.be37c498.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/36.f68470b2.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/38.10571145.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/39.91625f3e.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/4.67c56359.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/40.7624e351.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/41.64fc17ac.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/42.982865cf.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/43.d9e52ef4.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/44.ceca1b93.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/45.548c112a.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/46.78ab4e7a.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/47.4e1443b2.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/48.52917e17.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/5.c397ffe5.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/50.987eb2eb.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/51.ddc3d442.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/52.657fe2a7.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/53.cd02a60a.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/54.26e3ff32.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/55.7997dcfe.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/56.d2d6a79c.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/57.f668ee64.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/58.e4f7de44.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/59.2b497232.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/6.0dfb00be.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/60.718010a4.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/61.4c5bf94a.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/62.e415c60b.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/63.bee4456e.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/64.b96d6991.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/65.988ffa7f.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/66.1407089c.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/67.e45af5aa.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/68.042b0ded.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/69.aef532a8.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/70.909ab186.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/71.4ed07975.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/72.31befa51.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/9.a241c78d.js"><link rel="prefetch" href="/learn-wgpu-ko/assets/js/vendors~docsearch.d7f0baa9.js">
    <link rel="stylesheet" href="/learn-wgpu-ko/assets/css/0.styles.146801cf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="inner"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-wgpu-ko/" class="home-link router-link-active"><!----> <span class="site-name">WGPU 학습하기</span></a> <div class="links"><!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="docs-layout"><aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/learn-wgpu-ko/" aria-current="page" class="sidebar-link">소개</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>초보자</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-ko/beginner/tutorial1-window/" class="sidebar-link">의존성과 윈도우</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial2-surface/" class="sidebar-link">표면(The Surface)</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial3-pipeline/" class="sidebar-link">파이프라인</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial4-buffer/" class="sidebar-link">버퍼와 인덱스</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial5-textures/" class="sidebar-link">텍스처와 바인드 그룹</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial6-uniforms/" class="sidebar-link">유니폼 버퍼와 3D 카메라</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial7-instancing/" class="sidebar-link">인스턴싱(Instancing)</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial8-depth/" class="sidebar-link">깊이 버퍼 (The Depth Buffer)</a></li><li><a href="/learn-wgpu-ko/beginner/tutorial9-models/" class="sidebar-link">모델 로딩</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>중급자</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-ko/intermediate/tutorial10-lighting/" class="sidebar-link">조명 다루기</a></li><li><a href="/learn-wgpu-ko/intermediate/tutorial11-normals/" class="sidebar-link">노멀 매핑 (Normal Mapping)</a></li><li><a href="/learn-wgpu-ko/intermediate/tutorial12-camera/" class="sidebar-link">더 나은 카메라</a></li><li><a href="/learn-wgpu-ko/intermediate/tutorial13-hdr/" class="sidebar-link">하이 다이내믹 레인지 렌더링 (High Dynamic Range Rendering)</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>쇼케이스</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-ko/showcase/" aria-current="page" class="sidebar-link">들어가며</a></li><li><a href="/learn-wgpu-ko/showcase/windowless/" class="sidebar-link">창 없이 Wgpu 사용하기</a></li><li><a href="/learn-wgpu-ko/showcase/gifs/" aria-current="page" class="active sidebar-link">GIF 만들기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-wgpu-ko/showcase/gifs/#어떻게-gif를-만들까요" class="sidebar-link">어떻게 GIF를 만들까요?</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-ko/showcase/gifs/#어떻게-프레임을-만들까요" class="sidebar-link">어떻게 프레임을 만들까요?</a></li></ul></li><li><a href="/learn-wgpu-ko/showcase/pong/" class="sidebar-link">퐁 (Pong)</a></li><li><a href="/learn-wgpu-ko/showcase/compute/" class="sidebar-link">컴퓨트 예제: 탄젠트와 바이탄젠트 계산</a></li><li><a href="/learn-wgpu-ko/showcase/alignment/" class="sidebar-link">WGSL의 메모리 레이아웃</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>뉴스</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gif-만들기"><a href="#gif-만들기" class="header-anchor">#</a> GIF 만들기</h1> <p>가끔 멋진 시뮬레이션이나 애니메이션을 만들고 나면, 이를 자랑하고 싶을 때가 있습니다. 비디오를 녹화할 수도 있지만, 트위터에 올릴 간단한 결과물을 위해 비디오 녹화 프로그램을 사용하는 것은 좀 과할 수 있습니다. 바로 이럴 때 <a href="https://en.wikipedia.org/wiki/GIF" target="_blank" rel="noopener noreferrer">GIF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>가 유용합니다.</p> <p>참고로, GIF는 JIF(지프)가 아니라 GHIF(기프)로 발음합니다. JIF는 <a href="https://en.wikipedia.org/wiki/Jif_%28peanut_butter%29" target="_blank" rel="noopener noreferrer">땅콩버터<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 브랜드 이름일 뿐만 아니라, <a href="https://filext.com/file-extension/JIF" target="_blank" rel="noopener noreferrer">다른 이미지 형식<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>의 이름이기도 합니다.</p> <h2 id="어떻게-gif를-만들까요"><a href="#어떻게-gif를-만들까요" class="header-anchor">#</a> 어떻게 GIF를 만들까요?</h2> <p>실제 이미지를 인코딩하기 위해 <a href="https://docs.rs/gif/" target="_blank" rel="noopener noreferrer">gif 크레이트<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>를 사용하여 함수를 만들 것입니다.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">save_gif</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> frames<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span> speed<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token keyword">u16</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">failure<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token namespace">gif<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Frame</span><span class="token punctuation">,</span> <span class="token class-name">Encoder</span><span class="token punctuation">,</span> <span class="token class-name">Repeat</span><span class="token punctuation">,</span> <span class="token class-name">SetParameter</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> <span class="token keyword">mut</span> image <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token comment">// 원문 코드에 너비, 높이 인수가 누락되어 있습니다. 올바른 사용법은 다음과 같을 수 있습니다:</span>
    <span class="token comment">// let mut encoder = Encoder::new(&amp;mut image, size, size, &amp;[])?;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> encoder <span class="token operator">=</span> <span class="token class-name">Encoder</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> image<span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    encoder<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Repeat</span><span class="token punctuation">::</span><span class="token class-name">Infinite</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token keyword">mut</span> frame <span class="token keyword">in</span> frames <span class="token punctuation">{</span>
        <span class="token comment">// 원문 코드에 너비, 높이 인수가 누락되어 있습니다. 올바른 사용법은 다음과 같을 수 있습니다:</span>
        <span class="token comment">// encoder.write_frame(&amp;Frame::from_rgba_speed(size, size, &amp;mut frame, speed))?;</span>
        encoder<span class="token punctuation">.</span><span class="token function">write_frame</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token class-name">Frame</span><span class="token punctuation">::</span><span class="token function">from_rgba_speed</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> frame<span class="token punctuation">,</span> speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div> <p>이 코드를 사용하기 위해 필요한 것은 GIF의 프레임, 재생 속도, 그리고 GIF의 크기(너비와 높이를 따로 사용할 수도 있지만, 여기서는 하나로 사용했습니다)뿐입니다.</p> <h2 id="어떻게-프레임을-만들까요"><a href="#어떻게-프레임을-만들까요" class="header-anchor">#</a> 어떻게 프레임을 만들까요?</h2> <p><a href="/learn-wgpu-ko/showcase/windowless/#a-triangle-without-a-window">창 없는 쇼케이스</a>를 확인했다면, 우리가 <code>wgpu::Texture</code>에 직접 렌더링한다는 것을 아실 겁니다. 렌더링할 텍스처와 그 결과물을 복사할 버퍼를 생성할 것입니다.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// 렌더링할 텍스처 생성</span>
<span class="token keyword">let</span> texture_size <span class="token operator">=</span> <span class="token number">256u32</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> rt_desc <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureDescriptor</span> <span class="token punctuation">{</span>
    size<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Extent3d</span> <span class="token punctuation">{</span>
        width<span class="token punctuation">:</span> texture_size<span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> texture_size<span class="token punctuation">,</span>
        depth_or_array_layers<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mip_level_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    sample_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    dimension<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureDimension</span><span class="token punctuation">::</span><span class="token constant">D2</span><span class="token punctuation">,</span>
    format<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureFormat</span><span class="token punctuation">::</span><span class="token class-name">Rgba8UnormSrgb</span><span class="token punctuation">,</span>
    usage<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">COPY_SRC</span>
        <span class="token operator">|</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">RENDER_ATTACHMENT</span><span class="token punctuation">,</span>
    label<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> render_target <span class="token operator">=</span> <span class="token namespace">framework<span class="token punctuation">::</span></span><span class="token class-name">Texture</span><span class="token punctuation">::</span><span class="token function">from_descriptor</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device<span class="token punctuation">,</span> rt_desc<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// wgpu는 텍스처에서 버퍼로 복사 시 `wgpu::COPY_BYTES_PER_ROW_ALIGNMENT`에 맞춰</span>
<span class="token comment">// 정렬할 것을 요구합니다. 이 때문에, 패딩이 추가된 행당 바이트 수(padded_bytes_per_row)와</span>
<span class="token comment">// 패딩이 없는 행당 바이트 수(unpadded_bytes_per_row)를 모두 저장해야 합니다.</span>
<span class="token keyword">let</span> pixel_size <span class="token operator">=</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">;</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> align <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token constant">COPY_BYTES_PER_ROW_ALIGNMENT</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> unpadded_bytes_per_row <span class="token operator">=</span> pixel_size <span class="token operator">*</span> texture_size<span class="token punctuation">;</span>
<span class="token keyword">let</span> padding <span class="token operator">=</span> <span class="token punctuation">(</span>align <span class="token operator">-</span> unpadded_bytes_per_row <span class="token operator">%</span> align<span class="token punctuation">)</span> <span class="token operator">%</span> align<span class="token punctuation">;</span>
<span class="token keyword">let</span> padded_bytes_per_row <span class="token operator">=</span> unpadded_bytes_per_row <span class="token operator">+</span> padding<span class="token punctuation">;</span>

<span class="token comment">// 텍스처를 복사하여 데이터를 가져올 수 있도록 버퍼 생성</span>
<span class="token keyword">let</span> buffer_size <span class="token operator">=</span> <span class="token punctuation">(</span>padded_bytes_per_row <span class="token operator">*</span> texture_size<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferAddress</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> buffer_desc <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferDescriptor</span> <span class="token punctuation">{</span>
    size<span class="token punctuation">:</span> buffer_size<span class="token punctuation">,</span>
    usage<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferUsages</span><span class="token punctuation">::</span><span class="token constant">COPY_DST</span> <span class="token operator">|</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferUsages</span><span class="token punctuation">::</span><span class="token constant">MAP_READ</span><span class="token punctuation">,</span>
    label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;Output Buffer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    mapped_at_creation<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> output_buffer <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_buffer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buffer_desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>이제 프레임을 렌더링하고, 그 프레임을 <code>Vec&lt;u8&gt;</code>로 복사할 수 있습니다.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> frames <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token operator">&amp;</span>colors <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> encoder <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_command_encoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">CommandEncoderDescriptor</span> <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> rpass <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">begin_render_pass</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPassDescriptor</span> <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;GIF Pass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        color_attachments<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPassColorAttachment</span> <span class="token punctuation">{</span>
                view<span class="token punctuation">:</span> <span class="token operator">&amp;</span>render_target<span class="token punctuation">.</span>view<span class="token punctuation">,</span>
                resolve_target<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
                ops<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Operations</span> <span class="token punctuation">{</span>
                    load<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">LoadOp</span><span class="token punctuation">::</span><span class="token class-name">Clear</span><span class="token punctuation">(</span>
                        <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Color</span> <span class="token punctuation">{</span>
                            r<span class="token punctuation">:</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            g<span class="token punctuation">:</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            b<span class="token punctuation">:</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            a<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                    store<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">StoreOp</span><span class="token punctuation">::</span><span class="token class-name">Store</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        depth_stencil_attachment<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    rpass<span class="token punctuation">.</span><span class="token function">set_pipeline</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>render_pipeline<span class="token punctuation">)</span><span class="token punctuation">;</span>
    rpass<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">drop</span><span class="token punctuation">(</span>rpass<span class="token punctuation">)</span><span class="token punctuation">;</span>

    encoder<span class="token punctuation">.</span><span class="token function">copy_texture_to_buffer</span><span class="token punctuation">(</span>
        <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageCopyTexture</span> <span class="token punctuation">{</span>
            texture<span class="token punctuation">:</span> <span class="token operator">&amp;</span>render_target<span class="token punctuation">.</span>texture<span class="token punctuation">,</span>
            mip_level<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            origin<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Origin3d</span><span class="token punctuation">::</span><span class="token constant">ZERO</span><span class="token punctuation">,</span>
            aspect<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureAspect</span><span class="token punctuation">::</span><span class="token class-name">All</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageCopyBuffer</span> <span class="token punctuation">{</span>
            buffer<span class="token punctuation">:</span> <span class="token operator">&amp;</span>output_buffer<span class="token punctuation">,</span>
            layout<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageDataLayout</span> <span class="token punctuation">{</span>
                offset<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                bytes_per_row<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">NonZeroU32</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>padded_bytes_per_row<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                rows_per_image<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">NonZeroU32</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>texture_size<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        render_target<span class="token punctuation">.</span>desc<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    queue<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token function">once</span><span class="token punctuation">(</span>encoder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 맵핑 요청 생성</span>
    <span class="token keyword">let</span> buffer_slice <span class="token operator">=</span> output_buffer<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 비동기 맵핑 요청. 참고: map_async는 &amp;self를 받으므로 request 변수가 필요하지 않을 수 있습니다.</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>tx<span class="token punctuation">,</span> rx<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">futures_intrusive<span class="token punctuation">::</span>channel<span class="token punctuation">::</span>shared<span class="token punctuation">::</span></span><span class="token function">oneshot_channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer_slice<span class="token punctuation">.</span><span class="token function">map_async</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">MapMode</span><span class="token punctuation">::</span><span class="token class-name">Read</span><span class="token punctuation">,</span> <span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>result<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        tx<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// GPU 작업이 끝날 때까지 대기</span>
    device<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">PollType</span><span class="token punctuation">::</span><span class="token class-name">Wait</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> rx<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">;</span>
    
    <span class="token keyword">match</span> result <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> padded_data <span class="token operator">=</span> buffer_slice<span class="token punctuation">.</span><span class="token function">get_mapped_range</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 각 행에서 패딩을 제거하여 실제 이미지 데이터만 수집</span>
            <span class="token keyword">let</span> data <span class="token operator">=</span> padded_data
                <span class="token punctuation">.</span><span class="token function">chunks</span><span class="token punctuation">(</span>padded_bytes_per_row <span class="token keyword">as</span> _<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>chunk<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">&amp;</span>chunk<span class="token punctuation">[</span><span class="token punctuation">..</span>unpadded_bytes_per_row <span class="token keyword">as</span> _<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">flatten</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">copied</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">drop</span><span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            output_buffer<span class="token punctuation">.</span><span class="token function">unmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            frames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        _ <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">&quot;Something went wrong&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>이 작업이 끝나면 <code>save_gif()</code> 함수에 프레임들을 전달할 수 있습니다.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token function">save_gif</span><span class="token punctuation">(</span><span class="token string">&quot;output.gif&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> frames<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> texture_size <span class="token keyword">as</span> <span class="token keyword">u16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>이것이 기본적인 과정입니다. 텍스처 배열을 사용하고 그리기 명령을 한 번에 보내는 방식으로 성능을 개선할 수도 있지만, 이 예제는 기본적인 아이디어를 전달하는 데 중점을 둡니다. 제가 작성한 셰이더를 사용하면 다음과 같은 GIF를 얻을 수 있습니다.</p> <p><img src="/learn-wgpu-ko/assets/img/output.5ed23d6e.gif" alt="./output.gif"></p> <div class="auto-github-link"><a href="https://github.com/sotrh/learn-wgpu/tree/master/code/showcase/gifs/" target="_blank" rel="noopener noreferrer">Check out the code!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/11/2025, 8:57:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/learn-wgpu-ko/showcase/windowless/" class="prev">
          창 없이 Wgpu 사용하기
        </a></span> <span class="next"><a href="/learn-wgpu-ko/showcase/pong/">
          퐁 (Pong)
        </a>
        →
      </span></p></div> </main></div></div><div class="global-ui"><!----></div></div>
    <script src="/learn-wgpu-ko/assets/js/app.ed4e872b.js" defer></script><script src="/learn-wgpu-ko/assets/js/3.d666109b.js" defer></script><script src="/learn-wgpu-ko/assets/js/2.3bb15672.js" defer></script><script src="/learn-wgpu-ko/assets/js/49.a2e992fc.js" defer></script><script src="/learn-wgpu-ko/assets/js/37.a2b9f953.js" defer></script>
  </body>
</html>
